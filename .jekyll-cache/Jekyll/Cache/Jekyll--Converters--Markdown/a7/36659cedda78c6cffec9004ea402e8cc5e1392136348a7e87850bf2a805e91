I",<p><span style="border-bottom: 12px solid #dcf1fb; padding: 0 0 0 0.2em;">혼자공부하는머신러닝+딥러닝 수업을 참고하여 작성하였습니다</span></p>
<p><span style="border-bottom: 12px solid #dcf1fb; padding: 0 0 0 0.2em;">3_2_사이킷런으로 선형회귀모델 만들어보기</span></p>

<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>정의</title>
</head>
<body>

<pre>
</pre>

<p><span style="background: linear-gradient(to right, #ffa7a3, #5673bd); padding: 0.43em 1em; font-size: 19px; border-radius: 3px; color: #ffffff;">사이킷런으로 선형회귀모델 만들어보기</span></p>
<pre>
1. 50cm 농어의 이웃
</pre>
</body>
</html>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 50cm 농어의 이웃
</span><span class="n">distances</span><span class="p">,</span> <span class="n">indexes</span> <span class="o">=</span> <span class="n">knr</span><span class="p">.</span><span class="n">kneighbors</span><span class="p">([[</span><span class="mi">50</span><span class="p">]])</span>
<span class="c1"># 훈련 세트의 산점도
</span><span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">train_input</span><span class="p">,</span> <span class="n">train_target</span><span class="p">)</span>
<span class="c1"># 훈련 세트 중 이웃샘플만 다시 그리기
</span><span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">train_input</span><span class="p">[</span><span class="n">indexes</span><span class="p">],</span> <span class="n">train_target</span><span class="p">[</span><span class="n">indexes</span><span class="p">],</span> <span class="n">marker</span> <span class="o">=</span> <span class="s">'D'</span><span class="p">)</span>
<span class="c1"># 50cm 농어 데이터
</span><span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">1033</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s">'^'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>
<ima src="data:image/png;base64,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" alt="50cm 농어 이웃">

<body>
<pre>
2. 선형 회귀 (Linear regression)
- 농어무게 = a*농어길이 + b
</pre>
</body>

```python
from sklearn.linear_model import LinearRegression
lr = LinearRegression()
lr.fit(train_input, train_target)

print(lr.predict([[50]]))
# [531.14082146]
print(lr.coef_, lr.intercept_)
# [10.81181894] -9.45012573344502
```
<body>
<pre>
3. 회귀 모델 훈련
- 과소적합
- 과대적합
</pre>
</body>

```python
from sklearn.neighbors import KNeighborsRegressor

knr = KNeighborsRegressor()
knr.fit(train_input, train_target)
knr.score(test_input, test_target)

from sklearn.metrics import mean_absolute_error

test_prediction = knr.predict(test_input)
mae = mean_absolute_error(test_target, test_prediction)
print(mae)
```

<body>
<pre>
4. 이웃 개수 줄이기
- k 높을수록 과소적합
- k 낮을수록 과대적합
</pre>
</body>

```python
knr.n_neighbors = 3
knr.fit(train_input, train_target)

print(knr.score(train_input, train_target))
# 0.938709599713688
print(knr.score(test_input, test_target))
# 0.8942577363692543
```
</ima>
:ET